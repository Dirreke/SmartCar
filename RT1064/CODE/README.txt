改动：
注释search.c第79行开始my_key_debug()函数
注释search.h第25行my_key_debug()声明
注释Data_Send.h第28行extern PID PID_SPEED（在control里，输出参数用，先不迁了）
注释Data_Send.c第173-188行输出变量（都不要了，变量输出我们自己的）
注释search.c中429行开始的Road_rec()函数，因为EM相关变量、函数定义在control里
注释search.c中1197行开始的Pic_offset_fig()函数，因为cam_offset,em_offset在control里定义
注释search.c中1329行开始的Pic_offset_filter()函数，理由同上
注释search.c中1695行开始的避障部分，不迁移ToF.c，ToF.h两个激光测距模块
注释SEEKFREE_MT9V03X_SCI_ME.c中camera_dispose_main()函数第213行-232行，关于road=0~road=2的部分，因为变量Turn_Angle在control里定义
注释SEEKFREE_MT9V03X_SCI_ME.c中camera_dispose_main()函数第260 262 263行，因为上述search.c中对应函数被注释
更改SEEKFREE_MT9V03X_SCI_ME.c中Get_Use_Imge()函数调用的image函数，因为rt1064中该函数为mt9v03x_csi_image
注释SEEKFREE_MT9V03X_SCI_ME.c中image()函数声明，理由同上
注释SEEKFREE_MT9V03X_SCI_ME.c中camera_dispose_main()第225行对Road3_cnt的定义，因为未使用
更改/* 调试参数 */ 从main.c到search.c
注释search.c第793,814行
更改search.c第818行，添加return sum，变多出口为单出口，函数最后返回
注释search.c第907行，因为未使用
注释search.c第1635，1637行，因为未使用

//---------------------------------------------//

/** 191206 **/
改动：
加入 control.c&h
加入 pwm_me.c&h
加入 qtimer.c&h
更改 headfile.h 添加control.h/qtimer.h/pwm_me.h
取消注释Data_Send.h第28行extern PID PID_SPEED
添加search.c中50行对Cam_offset的定义
取消注释search.c中433行开始的Road_rec()函数
注释Road_rec()中oldwhite，Road1_cnt1，Road1_flag1变量，因为没有用到
注释search.c中63-73行，都是EM
注释search.c中482-493行，因为有关EM
注释第499行原先if条件，改为无EM判断
注释search.c中563-574行，因为有关EM
注释第580行原先if条件，改为无EM判断
取消注释search.c中1209行开始的Pic_offset_fig()函数，因为补充了Cam_offset定义
取消注释search.c中1339行开始的Pic_offset_filter()函数，理由同上
重写SEEKFREE_MT9V03X_SCI_ME.c中camera_dispose_main()函数第227行开始对road=0-2的部分，去掉turn_angle
取消注释SEEKFREE_MT9V03X_SCI_ME.c中第292,294,295行对Road_rec，Pic_offset_fig，Pic_offset_filter的声明

未改动:
注释search.c第93行开始my_key_debug()函数
注释search.h第25行my_key_debug()声明
注释Data_Send.c第173-188行输出变量（上位机换了）
注释search.c中1717行开始的避障部分，不迁移ToF.c，ToF.h两个激光测距模块
注释search.c第799,820行的return sum，添加824行的return sum，变多出口为单出口，函数在最后返回
注释search.c第907行static char road1_flag3，因为未使用
注释search.c第1640，1642行的int j，static char flag5 = 1，因为未使用
注释SEEKFREE_MT9V03X_SCI_ME.c中278行Pic_seedfill();这个不知道是哪里的，好像之前就注释掉了
更改SEEKFREE_MT9V03X_SCI_ME.c中Get_Use_Imge()函数调用的image函数，因为rt1064中该函数为mt9v03x_csi_image
注释SEEKFREE_MT9V03X_SCI_ME.c中image()函数声明，理由同上
注释SEEKFREE_MT9V03X_SCI_ME.c中camera_dispose_main()第225行对Road3_cnt的定义，因为未使用
更改/* 调试参数 */ 从main.c到search.c

//------------------------------------//

/**2019.12.07  **/
GMY

修改fsl_pwm.h中PWM_DUTY_MAX值为20000
修改电机频率为13000Hz，初始化后电机转速0；
设定舵机参数SERVO_MIDDLE以及SERVO_RANGE;
舵机Servo_duty中对duty限幅，以防duty溢出;
**Servo_duty输入量中心偏置放入duty函数中**
**Servo_duty输入改为float**
**新建Properties.h用于放置小车属性及其他参数;**

Cam_Turn_Control声明及定义由search.c迁移至control.h&c,
Cam_Turn_Control更名为Turn_Cam_Out
Turn_P_Cam更名为Turn_Cam_P;Turn_D_Cam更名为Turn_Cam_D;*_Table同
删除Cam_offset在control多余的声明和定义
//-------------------------------------//

/** 191208  **/
JMK&LKM

增加main.c的    Para_Init();    //各个变量初始化
增加function.c&h
增加diff.c&h
增加speed.c&h
更改isr.c第30行开始的void PIT_IRQHandler(void)函数
添加control.c第2行对差分函数get_diff_state的声明
取消control.c第5行对PID的注释
取消control.c第9行对motor_out的注释
添加control.c第11行对cam_offset_range的定义
添加control.h第17.18行对：float limit_f(float n, float lower, float higher);float my_limit(float a, float limit)的声明
添加control.h第22行Speed_Control()的声明
添加headfile.h对三个.h的include
properties内容遷移至function.c
#define中断时间
D12-L0
D13-L1
D0-R0
D1-R1
//-------------------------------------//

/** 191213 **/
ALL

修改function.h中舵机限幅为180（190极限）
修改function.h中舵机中位为1335
添加SEEKFREE_MT9V03X_CSI_ME.c第210-226行Get_pic_with_edge()函数定义，用于带边线的灰度图
添加SEEKFREE_MT9V03X_CSI_ME.hGet_pic_with_edge()函数的声明
添加SEEKFREE_MT9V03X_CSI_ME.c第316行Get_pic_with_edge()函数
修改SEEKFREE_MT9V03X_CSI.c中63行 MT9V03X_CFG_CSI[CONFIG_FINISH][2]的FPS为200
修改function.c第28行为diff_on()，开差速
修改function.c初始差速设定值：lib_set_speed(1.0);
取消control.c中第171-177行的注释，将speedTarget1/2替代SetSpeed1/2
A接右轮 B接左轮

//------------------------------//
/** 191215 **/
LKM&GMY

function.h中添加摄像头频率参数，置位100（200微暗）
修复Data_Send
加入串口初始化，波特率1500000
**上位机修复进程：
购置无线模块EPS8266-12F
经检查：
无线模块发射完好
无线模块协议完好（可以发送ICMP、等至上位机）
无线模块接收完好



//-----------------------------//
/** 191217 **/
GMY
更新去畸变方式为直线函数参数，而非查表，函数参数已重新标定
近景5行不准，56-60，用数据表标定，K0_Table；

修复Cam_offset
参照znc_final注释进圆环的判断
出圆环时仅用外边线判断 if改为elseif（不一定对，也可能是下一个elseif改成if，需要实验。
需要改参数Cam_offset
进圆环时，参照上次实验，左边线数据可能有问题。

创建并更新matlab程序；



//------------------------------//
/** 191218 **/
JMK
添加search.c部分括号，分号，(int)
添加search.c的Road_rec()部分注释、flag置位代码、进圆环补线距离
添加function.h对DIS_IN_CIRCLE的定义
（get_speed 需要km重新迁一下）
/** 1218 **/
GMY
修改diff原程序中的前后不符（前用数，后用宏定义）
**新写一套diff，因为调试周期可能比较长，故用选择编译：DIFF0：原程序，DIFF1：新程序，放在speed.h中
******************************************
km签get_speed()的时候可以写一下，
#ifdef DIFF0
 此时为speed+diff_bias

#endif
#ifdef DIFF1
 此时为speed
#endif
********************************************
新建车模参量放入function.h
修改原去畸变代码执行顺序，提高运算速度

**新写一套去畸变，因为调试周期可能比较长，故用选择编译，放在search.h中
****************************************
** 新程序中：
** MIDMAP=450；
需要修改近，远线参量等--search.h中；
***************************************
**发现原.h中有摄像头内参，如果可以可进一步去畸变



/***************************************/
/*** 1219 ***/
车宽15.5，车长20

/***********************************/
/** 1222 **/
LKM&JMK
注释SEEKFREE_ME断路的road=6和get01value（不更新阈值）
删除SEEKFREE_ME的sobel的i和远行判断
更改cam_offset映射表，从±192~±300
pd需进一步修改
dis从0.9改到1.1
进环后pd不够转向不足卡上了马路牙子
添加矫正后边线上位机显示
#ifdef ori_pic 原图像
#ifdef und_pic 去畸变边线
图像压缩丢失部分近景边线信息

/*****************************************/
/**20200117***/
ALL
改回Camoffset映射
录赛道视频

/******************************************/
/**20200118**/
注释部分无用代码

修改matlab代码为函数
简历GMY.c调试中，拟先计算New_Mid

/******************************************/
/**20200119**/
GMY

修改更新matlab程序，将程序改成函数
继续完成一般情况的Pic_DrawMid_und()；及对应matlab程序；
**原Cam_offset程序有严重错误：**
**左边线+右边线后应除以2！！！，否则与加半路宽情况不符**

**修改原去畸取景行，增加参数startpoint，新程序放入GMY.c，Pic_undistort（）；

/******************************************/
/**20200128**/
GMY 

**差速需要串PD

/******************************************/
/**20200206**/
完成中线绘制
写车正车直控制
其中
写中线圆的最小二乘拟合
Circle_R_calculate(void)
其中有参数12位去畸变时压缩比例
参数表y2_origin计算步骤见注释

/*****************************************/
/**20200511-20200520**/
ALL
焊接旧主板，调试；焊接驱动板，调试
绘制新主板
装配新车模，调节摄像头高度、位置
调节摄像头去畸，还需标定、系统辨识，更新部分matlab代码

测量主板电机信号，右轮电机端口D0无输出信号，左轮驱动信号正常

/*****************************************/
/**20200523**/
ALL
换新主板时需要改pwm_me.c 27-64行电机端口
测量电机信号，两轮驱动信号正常
调节后轮松紧度
更换右轮电机
更新git代码，包括：摄像头图像参数，电机端口

d3-l1
d1-l0
d2-r1
d0-r0
/**********************************************/
/**20200524**/
GMY
解决部分代码中文乱码问题
撰写电磁初始化代码及EM中线offset部分
撰写起跑线识别部分代码，，GMY.c
更新road.txt
/*************************************************/
/**20200525**/
ALL
调试电机，右轮不正常，更换左右轮电机线，左轮反转不正常
下次：
可以先测驱动板电压。
再更换引脚，左轮电机线接右轮，正转

摄像头参数标定和matlab标定算法撰写，参数计算
/************************************************/
/**20200527**/
ALL
调试电机，更换MOS管后正常。
摄像头棋盘格标定
关于去内畸变的讨论以及matlab部分代码撰写

修改摄像头相关行数指标
/****************************************************/
/**20200530**/
ALL
修改部分起始行为Fir_row
注释函数Pic_find_leap()，Pic_thresh_get(void)，Cam_End_Detect();
调电磁滑变、中间两个1.2，两侧1.0
摄像头参数修改基本完成，还有圆环待修改。
以0.5速度跑，十字可能有些问题，圆环未能判出
/****************************************************/
/**20200531**/
GMY 
放宽全白行条件
修改全白行远景补近景判定
增加左右转弯判断
增加中线计算函数
重写Cam_offset计算(基本上是整理，)
注释search.h中无用的声明
注释search.c中无用的定义

修改Draw_MId（找边线）的错误
重写边线寻找Pic_DrawMid(void)(左右边线函数)
加入最小二乘转弯办法JMK改完后加入control

完成起跑线识别，入库状态机初步；

下次计划：
舵机标定；
电机反转测试、停机测试；
圆环、十字、起跑线、新转弯
电磁好像还不对
/****************************************************/
/**20200602**/
GMY+JMK
修改边线bug
修改lef/rig_cir识别条件
增加上位机变量输出

可能问题：
slope斜率不为998进不去环
阈值过亮导致噪点多

下次计划：
棋盘格标定外参
舵机标定；
电机反转测试、停机测试；
圆环、十字、起跑线、新转弯
电磁好像还不对
 /****************************************************/
/**20200603**/
 GMY 
 再重写边线寻找Pic_DrawMid
 修改一些错误
 main降噪函数没有开
 阈值加-5偏置（原来是+5）

 /****************************************************/
/**20200603**/
 ALL
阈值加-2偏置
电磁好像就这样了
解决转弯判出十字的问题
解决入环flag初始化问题
修改圆环、十字、起跑线参数
调试边线寻找
速度=1 转弯压线 有噪音、左右弯未判出

下次计划：
棋盘格标定外参（不急）
舵机标定；
电机反转测试、停机测试；
圆环、十字、起跑线、旧转弯（新转弯不急）
阈值

/******************************************/
/**2020******/
舵机标定。

/******************************************/
/**20200610**/
ALL
转弯状态机调试完成并成功
整体阈值偏置修改
十字采用阈值偏置调试完成，还有点不稳
圆环识别调试完成
速度上2

下次计划
棋盘格标定外参（不急）
电机反转测试、停机测试；
（新转弯不急）
但出环4-3的过程判断条件应改善！！！！！
出圆环，进圆环补线可以加电磁辅助
起跑线
十字加速后可能还有问题！

/******************************************/
/**20200611**/
增加屏幕和debug

/******************************************/
/*20200612-20200615*/
转弯模糊PD表标定
重新调整摄像头高度
起跑线识别撰写和调试
数组越界问题的解决
转弯状态机参数修改
转弯采用阈值偏置

下次计划
棋盘格标定外参（不急）
电机反转测试、停机测试；
（新转弯不急）
但出环4-3的过程判断条件应改善！！！！！
出圆环，进圆环补线可以加电磁辅助
起跑线错误识别
弯道状态机失效
十字双补线书写

/******************************************/
/*20200617*/
更新十字补线，十字补线稍晚
更新转弯状态机，右转弯不对、

下次计划
棋盘格标定外参（不急）
电机反转测试、停机测试；
（新转弯不急）
但出环4-3的过程判断条件应改善！！！！！
出圆环，进圆环补线可以加电磁辅助
起跑线识别
电磁控制开始撰写

/******************************************/
/**20200619**/
修改边线越界问题
修改右转与左转不同
左边线有问题，怀疑编译仍然存在问题——已解决
放宽出转弯条件（把找弯道40条件变严）以避免起泡线进入过晚
修改一些错误

/******************************************/
/**20200620**/
整理control、qtimer、diff三个文件至control_new、speed_new、pwm_me等文件

/******************************************/
/**20200620-0621**/
ALL 
GMY+JMK

圆环补线、状态机转换状态全部重写并实现闭环。出圆环标志位5仍是开环
左弯道右弯道错误修改，解决问题，状态机正常。
阳关算法，去除过强反光。
修改整体阈值偏置为0。
修改左右10列增加阈值偏置 ，目前是-10，可能还需修改。

解决后轮晃动问题
书写部分电磁代码但未调试。

下次计划：
棋盘格标定外参（不急）
电机反转测试、停机测试；
（新转弯不急）
起跑线识别
电磁控制开始撰写
标志位2-4还有待调整，标志位5出环过程有待调整（出圆环标志位5仍是开环）
左右10列增加阈值偏置 ，目前是-10，可能还需修改，可以尝试给渐变，sobel阈值可能需要修改。
S弯过不去，打角不够，疑似由D造成。

圆环前大弯道曾识别出左环，需要处理！！！！！！



/******************************************/
/**20200621**/
修改起跑线错误
电磁：
1：电磁代码两种方案
2：圆环出环用电磁主跑
PCB：
1：所有电路板改丝印层加到铜层 驱动板换接口 主板的电源线孔画小一些
2：LPC的主板画一套
控制：
1:舵机PD
其它：
1：加陀螺仪判坡
2：出库入库


/******************************************/
/**20200623**/
GMY
修改补线
1.十字远景行补线用更多数据
2.圆环补线补分段直线，加大（减小）斜率

Data_Send前20行显示去畸后图像
应根据斜率重新计算赛道半宽，还没写完，GMY.c

/**************************************************/
/**20200623-0624**/
ALL
调节补线参数
修改十字等条件防起跑线误判
de了一些起跑线的bug
电磁滑变调节
电磁车正写入，调好PID
电磁车直写入，差不多调好PD
电磁车直会有舵机抖动
/*************************************************/
/**20200624**/
GMY + LKM
电磁调通
入库已调通，入库转弯晚
摄像头和电磁简单耦合，（十字和圆环用摄像头）
小车重装机械
PCB重绘螺柱尺寸及其他小问题
出入库与干簧管控制耦合
右编码器接触不良，使用左PWM！！！！！！！！！！！！！！！！！！！！！！！！

下次计划：
棋盘格标定外参（不急）
（新转弯不急）
电机PI调节！！！！！！！！！！！！！！！！！！！！！
电磁PD还需调节
摄像头PD需要调节
标志位5出环过程有待调整（出圆环标志位5仍是开环）
左右10列增加阈值偏置 ，目前是-10，可能还需修改，可以尝试给渐变，sobel阈值可能需要修改。
出库要写！！！！！！！！！！！！！！！！！！！！！！！（可以考虑和出环类似的方案）
换右轮编码器！！！！！！！！！！！！！！！！
加陀螺仪判坡
上锂电池
PCB：
和LCY商量一下一个主板画背面

